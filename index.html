<html>

<head>

</head>

<body>
    <svg id="container" height="600" width="1000" , style="border: solid 1px #000">
        <g id="body" style="transform:translate(150px,0px)"></g>
        <g id="yAxis"></g>
        <g id="xAxis"></g>

    </svg>
</body>
<script src="d3.js"></script>

<script>
    let body = d3.select("#body")
    d3.csv("emdatDisasters.csv").then(showData)

    function showData(disaster) {

        let disaster_count = d3.nest()
            .key(function(d) { return d.Type; })
            .rollup(function(v) { return v.length; })
            .entries(disaster);

        console.log(disaster_count);
        
        var max = Math.max.apply(Math,disaster_count.map(function(o){return o.value;}))


        //let max = d3.max(disaster_count)
        console.log(max)
        let scale = d3.scaleLinear().range([0, 800]).domain([0, max])
        

        let scalePosition = d3.scaleBand().range([0, 500]).domain(disaster_count.map(d => d.key))

        scalePosition.padding(0.3)

        let join = body.selectAll("rect")
            .data(disaster_count)

        join.enter()
            .append("rect")
            .style("fill", "blue")
            .style("stroke", "white")
            .style("width", d => scale(d.value))
            .style("height", scalePosition.bandwidth())
            .style("y", d => scalePosition(d.key))

        let xAxis = d3.axisBottom(scale)
            .ticks(5) 
        d3.select("#xAxis")
            .attr("transform", "translate(150, 500)")
        .call(xAxis)

        let yAxis = d3.axisLeft(scalePosition)
        d3.select("#yAxis")
            .attr("transform", "translate(150, 0)")
            .call(yAxis)

       

    }


</script>

</html>